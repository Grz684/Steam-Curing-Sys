(function(e,h){typeof exports=="object"&&typeof module<"u"?module.exports=h(require("vue")):typeof define=="function"&&define.amd?define(["vue"],h):(e=typeof globalThis<"u"?globalThis:e||self,e.MyVueComponent=h(e.Vue))})(this,function(e){"use strict";const h=Symbol(),B=Symbol(),P=Symbol();function T(p,s){p&&p.messageSignal?p.messageSignal.connect(r=>{try{const n=JSON.parse(r);s.value=n,console.log("Received message from PyQt:",n)}catch(n){console.error("Failed to parse message:",n),s.value={type:"unknown",content:r}}}):console.error("messageSignal not found on bridge")}function F(){const p=e.ref(null),s=e.ref(null),r=e.ref("");function n(){window.QWebChannel?new QWebChannel(window.qt.webChannelTransport,o=>{p.value=o,s.value=o.objects.bridge,console.log("QWebChannel initialized",o,o.objects.bridge),T(s.value,r),s.value&&typeof s.value.vueReady=="function"?s.value.vueReady():console.error("vueReady method not found on bridge")}):console.error("QWebChannel not found")}e.onMounted(()=>{document.readyState==="complete"||document.readyState==="interactive"?n():document.addEventListener("DOMContentLoaded",n)}),e.provide(h,e.readonly(p)),e.provide(B,e.readonly(s)),e.provide(P,e.readonly(r))}function w(){const p=e.inject(h),s=e.inject(B),r=e.inject(P);return(!p||!s||!r)&&console.error("WebChannel not properly provided. Make sure to call provideWebChannel in a parent component."),{channel:p,bridge:s,message:r,sendToPyQt:(o,l)=>{if(console.log(`Attempting to call ${o} with args:`,l),s&&s.value)if(typeof s.value.sendToPyQt=="function")try{s.value.sendToPyQt(o,JSON.stringify(l))}catch(i){console.error("Error calling sendToPyQt:",i)}else console.error("Method sendToPyQt not available on bridge"),console.log("Available methods:",Object.keys(s.value));else console.error("Bridge or bridge.value is undefined")}}}const k=(p,s)=>{const r=p.__vccOpts||p;for(const[n,o]of s)r[n]=o;return r},U={key:0,class:"numeric-keyboard"},K={class:"keyboard"},L={class:"current-value"},I=["onClick"],C=k({__name:"NumericKeyboard",props:{modelValue:{type:[String,Number],default:""},showKeyboard:{type:Boolean,default:!1}},emits:["update:modelValue","update:showKeyboard"],setup(p,{emit:s}){const r=p,n=s,o=e.ref([["7","8","9"],["4","5","6"],["1","2","3"],["清除","0","确定"]]),l=e.ref("");e.watch(()=>r.showKeyboard,f=>{f&&(l.value=r.modelValue.toString())});const i=f=>{f==="清除"?l.value="":f==="确定"?(n("update:modelValue",parseFloat(l.value)||0),n("update:showKeyboard",!1)):l.value+=f};return(f,y)=>p.showKeyboard?(e.openBlock(),e.createElementBlock("div",U,[e.createElementVNode("div",K,[e.createElementVNode("div",L,e.toDisplayString(l.value),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o.value,E=>(e.openBlock(),e.createElementBlock("div",{key:E.join(),class:"row"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(E,m=>(e.openBlock(),e.createElementBlock("button",{key:m,onClick:V=>i(m),class:e.normalizeClass({"function-key":m==="清除"||m==="确定"})},e.toDisplayString(m),11,I))),128))]))),128))])])):e.createCommentVNode("",!0)}},[["__scopeId","data-v-541feda2"]]),M={class:"settings-container"},q={class:"setting-group"},A={class:"setting-item"},j={class:"setting-controls"},R=["value"],z={class:"setting-item"},O={class:"setting-controls"},J=["value"],H={class:"setting-group"},G={class:"setting-item"},X={class:"setting-controls"},Y=["value"],Z={class:"setting-item"},ee={class:"setting-controls"},te=["value"],oe=k({__name:"SensorSettings",setup(p){const{sendToPyQt:s}=w(),r=e.reactive({isPyQtWebEngine:!1}),n=e.ref(30),o=e.ref(10),l=e.ref(80),i=e.ref(20),f=e.ref(!1),y=e.ref(null),E=e.ref("");e.onMounted(()=>{if(r.isPyQtWebEngine=typeof window.qt<"u"&&window.qt.webChannelTransport,r.isPyQtWebEngine){console.log("在PyQt QWebEngine环境中运行");const{message:d}=w();e.watch(d,t=>{if(t&&t.type==="update_limit_settings")try{const c=JSON.parse(t.content);n.value=c.temp_upper,o.value=c.temp_lower,l.value=c.humidity_upper,i.value=c.humidity_lower,console.log("Sensor Settings updated:",c)}catch(c){console.error("Failed to parse sensor settings data:",c)}})}else console.log("在普通网页环境中运行")});const m=(d,t)=>{const c=d==="tempUpper"?n:d==="tempLower"?o:d==="humidityUpper"?l:i;c.value=(c.value||0)+t,d.startsWith("temp")?V(d==="tempUpper"?"upper":"lower"):N(d==="humidityUpper"?"upper":"lower")},V=d=>{n.value===""&&(n.value=o.value+1),o.value===""&&(o.value=n.value-1),d==="upper"?n.value=Math.max(o.value+1,n.value):o.value=Math.min(n.value-1,o.value),_()},N=d=>{l.value===""&&(l.value=i.value+1),i.value===""&&(i.value=l.value-1),d==="upper"?l.value=Math.min(100,Math.max(i.value+1,l.value)):i.value=Math.max(0,Math.min(l.value-1,i.value)),_()},_=()=>{if(n.value!==""&&o.value!==""&&l.value!==""&&i.value!==""){const d={temp_upper:n.value,temp_lower:o.value,humidity_upper:l.value,humidity_lower:i.value};console.log("设置已更新:",d),r.isPyQtWebEngine?(console.log("在PyQt QWebEngine环境中执行更新设置"),s("updateLimitSettings",d)):console.log("在普通网页环境中执行更新设置")}},b=d=>{y.value=d,f.value=!0,E.value=d.startsWith("temp")?d==="tempUpper"?n.value:o.value:d==="humidityUpper"?l.value:i.value},v=d=>{const t=parseFloat(d);isNaN(t)||(y.value==="tempUpper"?(n.value=t,V("upper")):y.value==="tempLower"?(o.value=t,V("lower")):y.value==="humidityUpper"?(l.value=t,N("upper")):y.value==="humidityLower"&&(i.value=t,N("lower"))),y.value=null};return(d,t)=>(e.openBlock(),e.createElementBlock("div",M,[e.createElementVNode("div",q,[t[15]||(t[15]=e.createElementVNode("h2",null,"温度设置 (°C)",-1)),e.createElementVNode("div",A,[t[13]||(t[13]=e.createElementVNode("span",{class:"setting-label"},"上限：",-1)),e.createElementVNode("div",j,[e.createElementVNode("button",{onClick:t[0]||(t[0]=c=>m("tempUpper",-1))},"-"),e.createElementVNode("input",{type:"text",value:n.value,onFocus:t[1]||(t[1]=c=>b("tempUpper")),readonly:""},null,40,R),e.createElementVNode("button",{onClick:t[2]||(t[2]=c=>m("tempUpper",1))},"+")])]),e.createElementVNode("div",z,[t[14]||(t[14]=e.createElementVNode("span",{class:"setting-label"},"下限：",-1)),e.createElementVNode("div",O,[e.createElementVNode("button",{onClick:t[3]||(t[3]=c=>m("tempLower",-1))},"-"),e.createElementVNode("input",{type:"text",value:o.value,onFocus:t[4]||(t[4]=c=>b("tempLower")),readonly:""},null,40,J),e.createElementVNode("button",{onClick:t[5]||(t[5]=c=>m("tempLower",1))},"+")])])]),e.createElementVNode("div",H,[t[18]||(t[18]=e.createElementVNode("h2",null,"湿度设置 (%)",-1)),e.createElementVNode("div",G,[t[16]||(t[16]=e.createElementVNode("span",{class:"setting-label"},"上限：",-1)),e.createElementVNode("div",X,[e.createElementVNode("button",{onClick:t[6]||(t[6]=c=>m("humidityUpper",-1))},"-"),e.createElementVNode("input",{type:"text",value:l.value,onFocus:t[7]||(t[7]=c=>b("humidityUpper")),readonly:""},null,40,Y),e.createElementVNode("button",{onClick:t[8]||(t[8]=c=>m("humidityUpper",1))},"+")])]),e.createElementVNode("div",Z,[t[17]||(t[17]=e.createElementVNode("span",{class:"setting-label"},"下限：",-1)),e.createElementVNode("div",ee,[e.createElementVNode("button",{onClick:t[9]||(t[9]=c=>m("humidityLower",-1))},"-"),e.createElementVNode("input",{type:"text",value:i.value,onFocus:t[10]||(t[10]=c=>b("humidityLower")),readonly:""},null,40,te),e.createElementVNode("button",{onClick:t[11]||(t[11]=c=>m("humidityLower",1))},"+")])])]),e.createVNode(C,{modelValue:E.value,showKeyboard:f.value,"onUpdate:modelValue":v,"onUpdate:showKeyboard":t[12]||(t[12]=c=>f.value=c)},null,8,["modelValue","showKeyboard"])]))}},[["__scopeId","data-v-22394ea0"]]),ne={class:"sensor-data-group"},le={class:"sensor-section"},se={class:"sensor-container"},ae={class:"sensor-grid"},re={class:"sensor-title"},ie={class:"sensor-value"},de={class:"sensor-section"},ce={class:"sensor-container"},me={class:"sensor-grid"},ue={class:"sensor-title"},pe={class:"sensor-value"},ye=k({__name:"SensorDisplay",setup(p){const s=e.ref({temperature:{},humidity:{}});e.onMounted(()=>{if(typeof window.qt<"u"&&window.qt.webChannelTransport){console.log("在PyQt QWebEngine环境中执行");const{message:n}=w();e.watch(n,o=>{if(o&&o.type==="update_sensor_data")try{s.value=JSON.parse(o.content)}catch(l){console.error("Failed to parse sensor data:",l)}})}else console.log("在普通网页环境中执行"),r(),setInterval(r,5e3)});const r=async()=>{try{const n=await fetch("http://localhost:8000/api/sensor-data/");if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const o=await n.json();s.value=o}catch(n){console.error("Error fetching sensor data:",n)}};return(n,o)=>(e.openBlock(),e.createElementBlock("div",ne,[e.createElementVNode("div",le,[o[0]||(o[0]=e.createElementVNode("h2",null,"温度传感器",-1)),e.createElementVNode("div",se,[e.createElementVNode("div",ae,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value.temperature,(l,i)=>(e.openBlock(),e.createElementBlock("div",{key:i,class:"sensor-card"},[e.createElementVNode("div",re,e.toDisplayString(i),1),e.createElementVNode("div",ie,e.toDisplayString(l),1)]))),128))])])]),e.createElementVNode("div",de,[o[1]||(o[1]=e.createElementVNode("h2",null,"湿度传感器",-1)),e.createElementVNode("div",ce,[e.createElementVNode("div",me,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value.humidity,(l,i)=>(e.openBlock(),e.createElementBlock("div",{key:i,class:"sensor-card"},[e.createElementVNode("div",ue,e.toDisplayString(i),1),e.createElementVNode("div",pe,e.toDisplayString(l),1)]))),128))])])])]))}},[["__scopeId","data-v-947b9192"]]),fe={class:"cart-system"},ge={class:"mode-group"},Ee={class:"mode-content"},_e={key:0},be={class:"controls"},Ve={class:"input-group"},Ne={class:"input-group"},ve={class:"button-group"},he=["disabled"],we=["disabled"],ke={class:"visualization"},$e={class:"progress-bar"},Ce={class:"status"},Se={key:1,class:"auto-mode-container"},Qe=k({__name:"CartSystem",setup(p){const s=e.ref("semi-auto"),r=e.ref(6),n=e.ref(12),o=e.ref(r.value),l=e.ref(n.value),i=e.ref(r.value),f=e.ref(n.value),y=e.ref(!1),E=e.ref(0),m=e.ref("系统就绪"),V=e.ref("小车尚未工作"),N=e.ref(!1),_=e.ref(!1);let b=null;const{sendToPyQt:v}=w(),d=e.reactive({isPyQtWebEngine:!1});e.onMounted(()=>{if(d.isPyQtWebEngine=typeof window.qt<"u"&&window.qt.webChannelTransport,d.isPyQtWebEngine){console.log("在PyQt QWebEngine环境中运行");const{message:g}=w();e.watch(g,a=>{if(a&&a.type==="update_dolly_settings")try{const u=JSON.parse(a.content);o.value=u.dolly_single_run_time,l.value=u.dolly_run_interval_time,i.value=o.value,f.value=l.value,console.log("dolly Settings updated:",u)}catch(u){console.error("Failed to parse dolly settings data:",u)}else a&&a.type==="update_dolly_state"&&(a.content?Q("小车正在运行"):Q("小车尚未工作"))})}else console.log("在普通网页环境中运行")});const t=g=>{s.value=g,d.isPyQtWebEngine&&(g==="auto"?(W(),v("controlDolly",{target:"setMode",mode:"auto"})):(S(),Q("小车尚未工作"),v("controlDolly",{target:"setMode",mode:"semi-auto"})))},c=()=>{o.value=Math.max(1,parseInt(o.value)||1),i.value=o.value,D()},Fe=()=>{l.value=Math.max(0,parseInt(l.value)||0),f.value=l.value,D()};function D(){if(d.isPyQtWebEngine){console.log("在PyQt QWebEngine环境中执行更新设置");const g={target:"dolly_settings",dolly_single_run_time:i.value,dolly_run_interval_time:f.value};v("controlDolly",g)}else console.log("在普通网页环境中执行更新设置")}const Ue=()=>{y.value=!0,x()},W=()=>{S(),y.value=!1,cancelAnimationFrame(b),E.value=0,m.value="系统就绪"};function S(){d.isPyQtWebEngine?(console.log("在PyQt QWebEngine环境中执行更新设置"),v("controlDolly",{target:"setState",dolly_state:!1})):console.log("在普通网页环境中执行更新设置")}function Ke(){d.isPyQtWebEngine?(console.log("在PyQt QWebEngine环境中执行更新设置"),v("controlDolly",{target:"setState",dolly_state:!0})):console.log("在普通网页环境中执行更新设置")}const x=()=>{Ke(),m.value="小车运行中",E.value=0;const g=Date.now();r.value=i.value;const a=()=>{const u=(Date.now()-g)/1e3,$=Math.max(0,r.value-u);E.value=u/r.value*100,m.value=`小车运行中: 剩余 ${$.toFixed(1)} 秒`,u<r.value&&y.value?b=requestAnimationFrame(a):y.value&&(E.value=100,S(),Le())};b=requestAnimationFrame(a)},Le=()=>{m.value="等待下次运行";const g=Date.now();n.value=f.value;const a=()=>{const u=(Date.now()-g)/1e3,$=Math.max(0,n.value-u);m.value=`等待下次运行: ${$.toFixed(1)}秒`,$>0&&y.value?b=requestAnimationFrame(a):y.value&&x()};b=requestAnimationFrame(a)},Q=g=>{V.value=g};return e.onUnmounted(()=>{cancelAnimationFrame(b)}),(g,a)=>(e.openBlock(),e.createElementBlock("div",fe,[e.createElementVNode("div",ge,[e.createElementVNode("button",{class:e.normalizeClass(["mode-button",{active:s.value==="semi-auto"}]),onClick:a[0]||(a[0]=u=>s.value==="auto"?t("semi-auto"):()=>{})},"半自动模式",2),e.createElementVNode("button",{class:e.normalizeClass(["mode-button",{active:s.value==="auto"}]),onClick:a[1]||(a[1]=u=>s.value==="semi-auto"?t("auto"):()=>{})},"自动模式",2)]),e.createElementVNode("div",Ee,[s.value==="semi-auto"?(e.openBlock(),e.createElementBlock("div",_e,[e.createElementVNode("div",be,[e.createElementVNode("div",Ve,[a[8]||(a[8]=e.createElementVNode("label",null,"单次运行时间 (秒):",-1)),e.createElementVNode("div",{class:"input-wrapper",onClick:a[2]||(a[2]=u=>N.value=!0)},e.toDisplayString(o.value),1)]),e.createElementVNode("div",Ne,[a[9]||(a[9]=e.createElementVNode("label",null,"循环间隔时间 (秒):",-1)),e.createElementVNode("div",{class:"input-wrapper",onClick:a[3]||(a[3]=u=>_.value=!0)},e.toDisplayString(l.value),1)]),e.createElementVNode("div",ve,[e.createElementVNode("button",{onClick:Ue,disabled:y.value},"开始",8,he),e.createElementVNode("button",{onClick:W,disabled:!y.value},"停止",8,we)])]),e.createElementVNode("div",ke,[e.createElementVNode("div",$e,[e.createElementVNode("div",{class:"progress",style:e.normalizeStyle({width:E.value+"%"})},null,4),e.createElementVNode("div",{class:"cart",style:e.normalizeStyle({left:E.value+"%"})},a[10]||(a[10]=[e.createElementVNode("span",{class:"cart-icon"},"🚜",-1)]),4)])]),e.createElementVNode("div",Ce,e.toDisplayString(m.value),1)])):(e.openBlock(),e.createElementBlock("div",Se,[a[11]||(a[11]=e.createElementVNode("div",{class:"auto-mode-title"},"自动模式受传感器湿度控制",-1)),e.createElementVNode("div",{class:e.normalizeClass(["auto-mode-status",{working:V.value==="小车正在运行"}])},e.toDisplayString(V.value),3),a[12]||(a[12]=e.createElementVNode("div",{class:"auto-mode-placeholder"},null,-1))]))]),e.createVNode(C,{modelValue:o.value,"onUpdate:modelValue":[a[4]||(a[4]=u=>o.value=u),c],showKeyboard:N.value,"onUpdate:showKeyboard":a[5]||(a[5]=u=>N.value=u)},null,8,["modelValue","showKeyboard"]),e.createVNode(C,{modelValue:l.value,"onUpdate:modelValue":[a[6]||(a[6]=u=>l.value=u),Fe],showKeyboard:_.value,"onUpdate:showKeyboard":a[7]||(a[7]=u=>_.value=u)},null,8,["modelValue","showKeyboard"])]))}},[["__scopeId","data-v-6929ac4f"]]),Be={class:"data-actions"},Pe={key:0,class:"modal-overlay"},De={key:1,class:"modal-overlay"},We={class:"modal-content"},xe=k({__name:"DataExport",setup(p){const{sendToPyQt:s}=w(),r=e.reactive({isPyQtWebEngine:!1}),n=e.ref(!1),o=e.ref(!1),l=e.ref("");e.onMounted(()=>{r.isPyQtWebEngine=typeof window.qt<"u"&&window.qt.webChannelTransport,r.isPyQtWebEngine?console.log("在PyQt QWebEngine环境中运行"):console.log("在普通网页环境中运行")});const i=()=>{r.isPyQtWebEngine&&(console.log("导出数据"),s("exportData",!0))},f=()=>{n.value=!0},y=()=>{n.value=!1},E=()=>{console.log("清空数据"),n.value=!1,m("所有数据已清空！"),r.isPyQtWebEngine&&s("exportData",!1)},m=N=>{l.value=N,o.value=!0},V=()=>{o.value=!1};return(N,_)=>(e.openBlock(),e.createElementBlock("div",Be,[e.createElementVNode("div",{class:"action-buttons"},[e.createElementVNode("div",{class:"button-group"},[_[0]||(_[0]=e.createElementVNode("i",{class:"fas fa-file-excel"},null,-1)),e.createElementVNode("button",{onClick:i,class:"export-btn"},"导出数据")]),e.createElementVNode("div",{class:"button-group"},[_[1]||(_[1]=e.createElementVNode("i",{class:"fas fa-trash-alt"},null,-1)),e.createElementVNode("button",{onClick:f,class:"clear-btn"},"清空数据")])]),n.value?(e.openBlock(),e.createElementBlock("div",Pe,[e.createElementVNode("div",{class:"modal-content"},[_[2]||(_[2]=e.createElementVNode("p",null,"确定要清空所有数据吗？此操作不可撤销。",-1)),e.createElementVNode("div",{class:"modal-buttons"},[e.createElementVNode("button",{onClick:E,class:"confirm-btn"},"确定"),e.createElementVNode("button",{onClick:y,class:"cancel-btn"},"取消")])])])):e.createCommentVNode("",!0),o.value?(e.openBlock(),e.createElementBlock("div",De,[e.createElementVNode("div",We,[e.createElementVNode("p",null,e.toDisplayString(l.value),1),e.createElementVNode("div",{class:"modal-buttons"},[e.createElementVNode("button",{onClick:V,class:"confirm-btn"},"确定")])])])):e.createCommentVNode("",!0)]))}},[["__scopeId","data-v-86824edf"]]),Te={class:"settings-container"};return{__name:"App",setup(p){return F(),(s,r)=>(e.openBlock(),e.createElementBlock("div",Te,[r[0]||(r[0]=e.createElementVNode("h1",null,"涪特智能养护台车控制系统",-1)),e.createVNode(ye),e.createVNode(xe),e.createVNode(oe),e.createVNode(Qe)]))}}});
